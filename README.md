# Swift Macro Error Reproducible package

## Condition

1. `A` macro is memberAttribute macro that will add `B` macro to members.
2. `A` macro argument have `[any Any.Type]`
3. `B` macro is member macro.

## Stack dump when compile error

```
Please submit a bug report (https://swift.org/contributing/#reporting-bugs) and include the crash backtrace.
Stack dump:
0.	Program arguments: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/swift-frontend -frontend -emit-module -experimental-skip-non-inlinable-function-bodies-without-types /Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift -target arm64-apple-macos10.15 -Xllvm -aarch64-use-tbi -enable-objc-interop -stack-check -sdk /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX14.2.sdk -I /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Products/Debug -I /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/usr/lib -F /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Products/Debug/PackageFrameworks -F /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Products/Debug -F /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/Library/Frameworks -no-color-diagnostics -enable-testing -g -module-cache-path /Users/hyde/Library/Developer/Xcode/DerivedData/ModuleCache.noindex -profile-generate -profile-coverage-mapping -swift-version 5 -enforce-exclusivity=checked -Onone -D SWIFT_PACKAGE -D DEBUG -D Xcode -serialize-debugging-options -load-plugin-executable /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Products/Debug/MacroErrorReproduceMacros#MacroErrorReproduceMacros -package-name macroerrorreproduce -const-gather-protocols-file /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/Objects-normal/arm64/MacroErrorReproduceClient_const_extract_protocols.json -empty-abi-descriptor -validate-clang-modules-once -clang-build-session-file /Users/hyde/Library/Developer/Xcode/DerivedData/ModuleCache.noindex/Session.modulevalidation -Xcc -working-directory -Xcc /Users/hyde/Desktop/MacroErrorReproduce -resource-dir /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift -enable-anonymous-context-mangled-names -Xcc -ivfsstatcache -Xcc /Users/hyde/Library/Developer/Xcode/DerivedData/SDKStatCaches.noindex/macosx14.2-23C5030d-df0db8920d7ae99241a1bc0f08d2dced.sdkstatcache -Xcc -I/Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Products/Debug/include -Xcc -I/Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/DerivedSources-normal/arm64 -Xcc -I/Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/DerivedSources/arm64 -Xcc -I/Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/DerivedSources -Xcc -DSWIFT_PACKAGE -Xcc -DDEBUG=1 -module-name MacroErrorReproduceClient -disable-clang-spi -target-sdk-version 14.2 -target-sdk-name macosx14.2 -external-plugin-path /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX14.2.sdk/usr/lib/swift/host/plugins#/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX14.2.sdk/usr/bin/swift-plugin-server -external-plugin-path /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX14.2.sdk/usr/local/lib/swift/host/plugins#/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX14.2.sdk/usr/bin/swift-plugin-server -external-plugin-path /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/usr/lib/swift/host/plugins#/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/usr/bin/swift-plugin-server -external-plugin-path /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/usr/local/lib/swift/host/plugins#/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/usr/bin/swift-plugin-server -plugin-path /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift/host/plugins -plugin-path /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/local/lib/swift/host/plugins -emit-module-doc-path /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/Objects-normal/arm64/MacroErrorReproduceClient.swiftdoc -emit-module-source-info-path /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/Objects-normal/arm64/MacroErrorReproduceClient.swiftsourceinfo -serialize-diagnostics-path /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/Objects-normal/arm64/MacroErrorReproduceClient-master-emit-module.dia -emit-dependencies-path /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/Objects-normal/arm64/MacroErrorReproduceClient-master-emit-module.d -o /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/Objects-normal/arm64/MacroErrorReproduceClient.swiftmodule -emit-abi-descriptor-path /Users/hyde/Library/Developer/Xcode/DerivedData/MacroErrorReproduce-dwcwgbewcsqezrckspzmfarxnlmv/Build/Intermediates.noindex/MacroErrorReproduce.build/Debug/MacroErrorReproduceClient.build/Objects-normal/arm64/MacroErrorReproduceClient.abi.json
1.	Apple Swift version 5.9.2 (swiftlang-5.9.2.2.51 clang-1500.1.0.2.2)
2.	Compiling with the current language version
3.	While evaluating request TypeCheckSourceFileRequest(source_file "/Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift")
4.	While type-checking 'Foo' (at /Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift:4:1)
5.	While type-checking 'Inside' (at /Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift:5:5)
6.	While evaluating request StoredPropertiesRequest(MacroErrorReproduceClient.(file).Foo.Inside@/Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift:5:12)
7.	While evaluating request ExpandSynthesizedMemberMacroRequest(MacroErrorReproduceClient.(file).Foo.Inside@/Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift:5:12)
8.	While evaluating request ResolveMacroRequest(custom-attr, 0x14d191028 StructDecl name=Foo)
9.	While type-checking expression at [/Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift:3:1 - line:3:29] RangeText="@TestMacro(label: [Int.self]"
10.	While type-checking-target starting at /Users/hyde/Desktop/MacroErrorReproduce/Sources/MacroErrorReproduceClient/main.swift:3:1
Stack dump without symbol names (ensure you have llvm-symbolizer in your PATH or set the environment var `LLVM_SYMBOLIZER_PATH` to point to it):
0  swift-frontend           0x000000010a054c40 llvm::sys::PrintStackTrace(llvm::raw_ostream&, int) + 56
1  swift-frontend           0x000000010a0539dc llvm::sys::RunSignalHandlers() + 112
2  swift-frontend           0x0000000105d9e668 SignalHandler(int) + 352
3  libsystem_platform.dylib 0x0000000194422a24 _sigtramp + 56
4  swift-frontend           0x000000010699e898 (anonymous namespace)::ConstraintWalker::walkToExprPost(swift::Expr*) (.llvm.10514007196147898556) + 240
5  swift-frontend           0x00000001054b18c8 (anonymous namespace)::Traversal::visitCollectionExpr(swift::CollectionExpr*) + 200
6  swift-frontend           0x000000010604cde0 (anonymous namespace)::Traversal::visit(swift::Expr*) (.llvm.1980535031488380796) + 108
7  swift-frontend           0x0000000104c58d24 (anonymous namespace)::Traversal::doIt(swift::ArgumentList*) (.llvm.1980535031488380796) + 176
8  swift-frontend           0x0000000106057d8c (anonymous namespace)::Traversal::visitMacroExpansionExpr(swift::MacroExpansionExpr*) + 472
9  swift-frontend           0x000000010604d214 (anonymous namespace)::Traversal::visit(swift::Expr*) (.llvm.1980535031488380796) + 1184
10 swift-frontend           0x0000000108b4c024 swift::constraints::ConstraintSystem::generateConstraints(swift::Expr*, swift::DeclContext*, bool) + 220
11 swift-frontend           0x000000010699b210 swift::constraints::ConstraintSystem::generateConstraints(swift::constraints::SyntacticElementTarget&, swift::FreeTypeVariableBinding) + 1264
12 swift-frontend           0x0000000108cb7f84 swift::constraints::ConstraintSystem::solve(swift::constraints::SyntacticElementTarget&, swift::FreeTypeVariableBinding) + 932
13 swift-frontend           0x000000010970c83c swift::TypeChecker::typeCheckTarget(swift::constraints::SyntacticElementTarget&, swift::OptionSet<swift::TypeCheckExprFlags, unsigned int>) + 680
14 swift-frontend           0x0000000106fb1b30 swift::TypeChecker::typeCheckExpression(swift::constraints::SyntacticElementTarget&, swift::OptionSet<swift::TypeCheckExprFlags, unsigned int>) + 436
15 swift-frontend           0x0000000107115dfc swift::ResolveMacroRequest::evaluate(swift::Evaluator&, swift::UnresolvedMacroReference, swift::DeclContext*) const + 1436
16 swift-frontend           0x00000001099cdcd4 llvm::Expected<swift::ResolveMacroRequest::OutputType> swift::Evaluator::getResultUncached<swift::ResolveMacroRequest>(swift::ResolveMacroRequest const&) + 636
17 swift-frontend           0x00000001070d4c60 llvm::Expected<swift::ResolveMacroRequest::OutputType> swift::Evaluator::getResultCached<swift::ResolveMacroRequest, (void*)0>(swift::ResolveMacroRequest const&) + 284
18 swift-frontend           0x00000001078a4410 swift::Decl::getResolvedMacro(swift::CustomAttr*) const + 292
19 swift-frontend           0x0000000107125354 isFromExpansionOfMacro(swift::SourceFile*, swift::MacroDecl*, swift::MacroRole) + 680
20 swift-frontend           0x0000000109a4b33c evaluateAttachedMacro(swift::MacroDecl*, swift::Decl*, swift::CustomAttr*, bool, swift::MacroRole, llvm::ArrayRef<swift::ProtocolDecl*>, llvm::StringRef) + 524
21 swift-frontend           0x000000010713fab8 void llvm::function_ref<void (swift::CustomAttr*, swift::MacroDecl*)>::callback_fn<swift::ExpandSynthesizedMemberMacroRequest::evaluate(swift::Evaluator&, swift::Decl*) const::$_2>(long, swift::CustomAttr*, swift::MacroDecl*) (.llvm.14280479643411933662) + 216
22 swift-frontend           0x00000001078a401c swift::Decl::forEachAttachedMacro(swift::MacroRole, llvm::function_ref<void (swift::CustomAttr*, swift::MacroDecl*)>) const + 696
23 swift-frontend           0x0000000107111dc0 swift::ExpandSynthesizedMemberMacroRequest::evaluate(swift::Evaluator&, swift::Decl*) const + 84
24 swift-frontend           0x0000000106ff8368 llvm::Expected<swift::ExpandSynthesizedMemberMacroRequest::OutputType> swift::Evaluator::getResultUncached<swift::ExpandSynthesizedMemberMacroRequest>(swift::ExpandSynthesizedMemberMacroRequest const&) + 648
25 swift-frontend           0x0000000106ff8050 llvm::Expected<swift::ExpandSynthesizedMemberMacroRequest::OutputType> swift::Evaluator::getResultCached<swift::ExpandSynthesizedMemberMacroRequest, (void*)0>(swift::ExpandSynthesizedMemberMacroRequest const&) + 344
26 swift-frontend           0x0000000109d83ba8 computeLoweredProperties(swift::NominalTypeDecl*, swift::IterableDeclContext*, (anonymous namespace)::LoweredPropertiesReason) + 156
27 swift-frontend           0x0000000109d80d3c swift::StoredPropertiesRequest::evaluate(swift::Evaluator&, swift::NominalTypeDecl*) const + 460
28 swift-frontend           0x00000001079750cc llvm::Expected<swift::StoredPropertiesRequest::OutputType> swift::Evaluator::getResultCached<swift::StoredPropertiesRequest, (void*)0>(swift::StoredPropertiesRequest const&) + 1328
29 swift-frontend           0x00000001078e0010 swift::NominalTypeDecl::getStoredProperties() const + 132
30 swift-frontend           0x000000010996d3e4 (anonymous namespace)::DeclChecker::visit(swift::Decl*) (.llvm.5139545417519374486) + 2112
31 swift-frontend           0x000000010996d548 (anonymous namespace)::DeclChecker::visit(swift::Decl*) (.llvm.5139545417519374486) + 2468
32 swift-frontend           0x0000000107095240 swift::TypeChecker::typeCheckDecl(swift::Decl*, bool) + 220
33 swift-frontend           0x00000001072e2428 swift::TypeCheckSourceFileRequest::evaluate(swift::Evaluator&, swift::SourceFile*) const + 432
34 swift-frontend           0x0000000109e95e14 llvm::Expected<swift::TypeCheckSourceFileRequest::OutputType> swift::Evaluator::getResultUncached<swift::TypeCheckSourceFileRequest>(swift::TypeCheckSourceFileRequest const&) + 664
35 swift-frontend           0x0000000109e8d420 swift::TypeCheckSourceFileRequest::OutputType swift::evaluateOrDefault<swift::TypeCheckSourceFileRequest>(swift::Evaluator&, swift::TypeCheckSourceFileRequest, swift::TypeCheckSourceFileRequest::OutputType) + 228
36 swift-frontend           0x0000000107918544 swift::CompilerInstance::performSema() + 296
37 swift-frontend           0x00000001098fd72c performCompile(swift::CompilerInstance&, int&, swift::FrontendObserver*) + 464
38 swift-frontend           0x0000000109901e6c swift::performFrontend(llvm::ArrayRef<char const*>, char const*, void*, swift::FrontendObserver*) + 4568
39 swift-frontend           0x0000000109960864 swift::mainEntry(int, char const**) + 4408
40 dyld                     0x000000019409bf28 start + 2236
LLVM Profile Error: Failed to write file "default.profraw": Operation not permitted
Command SwiftEmitModule failed with a nonzero exit code
```
